<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Seyram A. Butame">
<meta name="dcterms.date" content="2023-06-20">

<title>Our World in Data Energy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="20230606TT_files/libs/clipboard/clipboard.min.js"></script>
<script src="20230606TT_files/libs/quarto-html/quarto.js"></script>
<script src="20230606TT_files/libs/quarto-html/popper.min.js"></script>
<script src="20230606TT_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="20230606TT_files/libs/quarto-html/anchor.min.js"></script>
<link href="20230606TT_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="20230606TT_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="20230606TT_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="20230606TT_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="20230606TT_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#our-world-in-energy" id="toc-our-world-in-energy" class="nav-link active" data-scroll-target="#our-world-in-energy">Our World in Energy</a></li>
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries">Libraries</a></li>
  <li><a href="#set-up-canvas" id="toc-set-up-canvas" class="nav-link" data-scroll-target="#set-up-canvas">Set Up Canvas</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load Data</a></li>
  <li><a href="#examine-the-data" id="toc-examine-the-data" class="nav-link" data-scroll-target="#examine-the-data">Examine the Data</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data Wrangling</a></li>
  <li><a href="#plot-aesthetics" id="toc-plot-aesthetics" class="nav-link" data-scroll-target="#plot-aesthetics">Plot Aesthetics</a></li>
  <li><a href="#defining-the-font" id="toc-defining-the-font" class="nav-link" data-scroll-target="#defining-the-font">Defining the Font</a></li>
  <li><a href="#defining-titles-and-captions" id="toc-defining-titles-and-captions" class="nav-link" data-scroll-target="#defining-titles-and-captions">Defining Titles and Captions</a></li>
  <li><a href="#create-the-plot" id="toc-create-the-plot" class="nav-link" data-scroll-target="#create-the-plot">Create the Plot</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="20230606TT.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Our World in Data Energy</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Seyram A. Butame </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 20, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="our-world-in-energy" class="level2">
<h2 class="anchored" data-anchor-id="our-world-in-energy">Our World in Energy</h2>
<p>For this week, I wanted to try my hands at creating a visual document, and not just one chart. I wanted to put together a single document that displayed a collection of charts, such that the individual document would tell a story. Think in a similar manner to what you see on dashboards, but with static images. Interactivity is sometimes overrated, given that you have to click around all over the place. Before you do start, be sure to sketch out what you want. Just give you a rough idea of what you want your final output to look like. I am going for something that looks like the below.</p>
<figure class="img1 figure">
<img src="img/draft.jpg" alt="Draft of Data Viz" width="45%" class="figure-img">
<figcaption class="figcap figure-caption">
Figure 1 - Draft plan for the data visualization.
</figcaption>
</figure>
<p>I want to thank <a href="https://www.linkedin.com/in/stevenponce/">Steven Ponce </a> for the code guidance and the inspiration. The visual document he created of US energy consumption was similar to what I had in mind (see below). Very nice work.</p>
<figure class="img1 figure">
<img src="img/spenergy.jpg" alt="Steven Ponce US Energy" width="45%" class="figure-img">
<figcaption class="figcap figure-caption">
Figure 2 - Steven Ponce data TidyTuesday visual of US energy consumption.
</figcaption>
</figure>
</section>
<section id="libraries" class="level2">
<h2 class="anchored" data-anchor-id="libraries">Libraries</h2>
<ol type="1">
<li><code>tidytuesdayR</code> –<span class="citation" data-cites="hughes2019-st"><sup><a href="#ref-hughes2019-st" role="doc-biblioref">1</a></sup></span></li>
<li><code>tidyverse</code> – Workhorse suite of packages. Comes with <code>stringr</code>, which “provide a powerful and elegant syntax for interpolating strings.”<span class="citation" data-cites="2019Wickham-td"><sup><a href="#ref-2019Wickham-td" role="doc-biblioref">2</a></sup></span></li>
<li><code>ggtext</code> – Provides simple Markdown and HTML rendering for ggplot2.<span class="citation" data-cites="2022Wilke-wt"><sup><a href="#ref-2022Wilke-wt" role="doc-biblioref">3</a></sup></span></li>
<li><code>showtext</code> –<span class="citation" data-cites="2022Qiu-px"><sup><a href="#ref-2022Qiu-px" role="doc-biblioref">4</a></sup></span></li>
<li><code>janitor</code> –<span class="citation" data-cites="2023Firke-jw"><sup><a href="#ref-2023Firke-jw" role="doc-biblioref">5</a></sup></span></li>
<li><code>camcorder</code> –<span class="citation" data-cites="2022Hughes-cc"><sup><a href="#ref-2022Hughes-cc" role="doc-biblioref">6</a></sup></span></li>
<li><code>here</code> – A Simpler Way to Find Your Files. I have never used this package before but it is great. In particular the <code>here()</code> will find project files based on the current working directory.<span class="citation" data-cites="2020Müller-hr"><sup><a href="#ref-2020Müller-hr" role="doc-biblioref">7</a></sup></span></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytuesdayR)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(showtext)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(camcorder)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="set-up-canvas" class="level2">
<h2 class="anchored" data-anchor-id="set-up-canvas">Set Up Canvas</h2>
<p>I found a nifty little feature in R, where you can set up the canvas that will hold the chart or visual document. Additionally you can record various iterations of your project, that way you look through the progress. This comes via the <code>camcorder</code> package and the <code>gg_record()</code>. With the gg_record() function, you set up the dimensions of the visual chart or document (breadth, width etc.), the format (e.g., png, pdf, jpeg etc.), the directory where it is stored (the <code>here()</code> function comes in handy at this point), and set the resolution of the image in dpi.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FIGURE SIZE/ CANVAS ---- </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_record</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dir    =</span> <span class="fu">here</span>(<span class="st">"plots"</span>), </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">device =</span> <span class="st">"png"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">width  =</span> <span class="dv">6</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">6</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">units  =</span> <span class="st">"in"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">dpi    =</span> <span class="dv">600</span>) </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># TEXT Resolution ---- </span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_opts</span>(<span class="at">dpi =</span> <span class="dv">600</span>) <span class="co">#  Via the showtext package. And sets the resolution options for the text in the visuals created.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load Data</h2>
<p>Once we have our canvas set up, we can then read in our data. This week for TidyTuesday we are using the Our World In Data (OWID) Energy data. Lots of different ways to access the tidytuesday data. The <code>tidytuesdayR</code> package and its tt_load() function is a good way of accessing the data object via an API. You can then access the specific dataframe from the object via its name. Don’t forget to save it. I typically prefer to save them as csv files (i.e., comma-separated), as they are lightweight and readable in many programs. Take note that I use the <code>clean_names()</code> function to read in stored data. This function via the <code>janitor</code> package ensures that the resulting names are unique and consist only of the characters, numbers, and letters. Capitalization preferences may be specified using the case parameter.</p>
<p>The <strong>owid_energy</strong> dataframe contains 129 variables and 21890 observations.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 2. READ IN THE DATA ----</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tuesdata &lt;- tt_load(2023, week = 23) </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># owid_energy &lt;- tuesdata$`owid-energy` %&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   write_csv(owid_energy, "data/owid_energy.csv")</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(owid_energy, "data/owid_energy.csv") </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>owid_energy <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/owid_energy.csv"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="examine-the-data" class="level2">
<h2 class="anchored" data-anchor-id="examine-the-data">Examine the Data</h2>
<p>It is a good idea to examine a dataframe (i.e., data set) when unfamiliar with the data. There are a few functions from the <code>dplyr</code> and base R you can use for this process. The <code>glimpse()</code> from <code>dplyr</code> is similar to the <strong>describe</strong> command in Stata. However, it provides a transposed version of the data with columns running down the page, and data runs across. It’s a good way to see all the columns at a go.</p>
<p>The <code>str()</code> function or structure function, provides a similar approach to <code>glimpse()</code>. But it provides detail in a different way perhaps in a more readable manner. I also use the <code>view()</code> function, which will display the data in a spreadsheet format, like you would get with Excel or GoogleSheets. The <code>head()</code> from the utils package from base R is also a good option, but it only will show the first five observations and will typically truncate the list of variables. However, the function colnames() will show the list of the columns.</p>
<p>The range() function from base R will show you the min and max values of a particular variable.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- EXAMINING THE DATA ----</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># glimpse(owid_energy)  </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>insp1 <span class="ot">&lt;-</span> <span class="fu">head</span>(owid_energy)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>insp2 <span class="ot">&lt;-</span> owid_energy <span class="sc">%&gt;%</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(iso_code) <span class="sc">%&gt;%</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(iso_code)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>insp3 <span class="ot">&lt;-</span> <span class="fu">range</span>(owid_energy<span class="sc">$</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here is what I notice with the data given the above commands (note that they create data objects which you can then view):</p>
<ol type="1">
<li><p>With the above we first see that our data is arranged in the wide format (i.e., values do not repeat in the first column). To effectively create plots, particularly for multiple years, I will need to pivot the data longer (i.e., repeat observations by year).</p></li>
<li><p>There is a lot of data here, for all the countries in the world and for multiple years. The <code>range()</code> for the year variable shows that we have data points from 1900 to 2022. Similarly, the inspection of the unique values of the iso_code shows that there are 219 unique codes (i.e., 219 countries and territories). The iso-code<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> is a unique code that represents each unique country or territory.</p></li>
</ol>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">Data Wrangling</h2>
<p>The objective here is to create a subsample of the data for analysis. As I noted, the dataset is pretty big. If you look at the Our World in Data website, their dataset contains information from multiple years, multiple countries, and even contains aggregates by year. Furthermore, there are many variables pertaining to electricity consumption and electricity consumption per capita based on the raw material used to consume electricity (e.g., coal, wind, hydro-electric).</p>
<p>You can certainly create a visualization for all of that data (interactive choropleth maps may be one way to achieve this), but I want to keep things a bit simple. I have chosen to focus on China (iso-code: <strong>CHN</strong>). I have been a bit fascinated with China of late, so let’s do that. Furthermore, I am interested in the per capita production of electricity by source.</p>
<p>Electricity consumption typically is measured in terms of kilowatt-hours. We use the <code>select()</code> from <code>dplyr</code> to pick specific variables we want for our visual document which are all the variables from country to gdp inclusive and all the variables that end with the string “elec_per_capita” (we employ the “<em>helper</em>” function <code>ends_with()</code>).</p>
<p>Then we pivot our table longer to make it easier to plot the data. If you work with Tableau you will know that this is the format Tableau prefers when using data to create visual representations. For our purposes, we want the data only in the columns showing electricity generated per capita while keeping all the other variables (country, year, iso_code, population, gdp) constant. To pivot data we use the <code>pivot_longer()</code> function from <em>dplyr</em>.</p>
<p>Then because the variable names created are long and cumbersome for instance, “hydro_elec_per_capita.” We can create another variable that will describe the <strong>type</strong> of energy used to produce the data. For example, the type <em>hydroelectric</em> will correspond to the hydro_elec_per_capita value under energy. We do this using the <code>mutate()</code> function in combination with the <code>case_when()</code> function.</p>
<p>We also employ the <code>as_factor()</code> within the <code>mutate()</code> function to ensure that the type variable is a factor, that is it is categorical (i.e., ten categories). In Stata you would see these listed as 1 through 10 if you were using the tabulate function. Furthermore, we can order the factor levels using the function <code>fct_relevel()</code>.</p>
<p>Now we create a variable that will contain a note to be used in the overall theme of the visual document. The document created by Ponce, shows time in years on the x-axis and kilowatt hours on the y-axis. In addition, that fact they make use of two colors. One color (i.e., green) shows increases in the kilowatt hours of electricity consumption per capita over time. While decreases in the kilowatt hours of electricity production per capita over time are shown by the color red. To make theming our visual document in this manner it is easier to create a variable that denotes these colors, which can be read into the ggplot aesthetic layer. So essentially, you define the variable, then you define the colors as a separate object later on. You then tell <code>ggplot</code>, what to color by.</p>
<p>Another great tool in the Tidyverse suite is the pipe operator (<code>%&gt;%</code>), which may be used to chain various functions. Great for data wrangling and when working with a data file requiring a lot of changes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- PREPARE A SUBSAMPLE DATA ----</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> owid_energy <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(iso_code <span class="sc">==</span> <span class="st">"CHN"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country<span class="sc">:</span>gdp, <span class="fu">ends_with</span>(<span class="st">"elec_per_capita"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivot the data ---</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols      =</span> <span class="sc">!</span><span class="fu">c</span>(country, year, iso_code, population, gdp),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">names_to  =</span>  <span class="st">"energy"</span>, <span class="co"># Energy generated per capita</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">"output"</span>)  <span class="sc">%&gt;%</span> <span class="co"># Value of electiricity geernated in kilowatt hours</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change the names ---</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>            energy <span class="sc">==</span> <span class="st">"hydro_elec_per_capita"</span>      <span class="sc">~</span> <span class="st">"Hydroelectric"</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>            energy <span class="sc">==</span> <span class="st">"nuclear_elec_per_capita"</span>    <span class="sc">~</span> <span class="st">"Nuclear"</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>            energy <span class="sc">==</span> <span class="st">"solar_elec_per_capita"</span>      <span class="sc">~</span> <span class="st">"Solar"</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>            energy <span class="sc">==</span> <span class="st">"wind_elec_per_capita"</span>       <span class="sc">~</span> <span class="st">"Wind"</span>,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>            energy <span class="sc">==</span> <span class="st">"low_carbon_elec_per_capita"</span> <span class="sc">~</span> <span class="st">"Low Carbon"</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>            energy <span class="sc">==</span> <span class="st">"biofuel_elec_per_capita"</span>    <span class="sc">~</span> <span class="st">"Biofuel"</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>            energy <span class="sc">==</span> <span class="st">"oil_elec_per_capita"</span>        <span class="sc">~</span> <span class="st">"Oil"</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>            energy <span class="sc">==</span> <span class="st">"gas_elec_per_capita"</span>        <span class="sc">~</span> <span class="st">"Gas"</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>            energy <span class="sc">==</span> <span class="st">"renewables_elec_per_capita"</span>  <span class="sc">~</span> <span class="st">"Renewables"</span>,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span>                                   <span class="sc">~</span> <span class="st">'Others'</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">as_factor</span>(type)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Attach color variabble ----</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">highlight =</span> <span class="fu">if_else</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Oil"</span>), <span class="st">"down"</span>, <span class="st">"up"</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span> </span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reorder the "type" factor variable ---</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span>  <span class="fu">fct_relevel</span>(type, <span class="fu">c</span>(<span class="st">"Gas"</span>, <span class="st">"Low Carbon"</span>, <span class="st">"Renewables"</span>, <span class="st">"Solar"</span>, <span class="st">"Wind"</span>,</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Biofuel"</span>, <span class="st">"Nuclear"</span>, <span class="st">"Hydroelectric"</span>, <span class="st">"Oil"</span>)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>                             )) <span class="sc">%&gt;%</span> </span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Drop NA ----</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plot-aesthetics" class="level2">
<h2 class="anchored" data-anchor-id="plot-aesthetics">Plot Aesthetics</h2>
<p>This mainly has to do with the color and background of the plot. And the text used on the plot. I like to go with a light background contrasted with dark lettering. Others prefer to go with a dark background with light lettering. It is up to you.</p>
<ul>
<li><p>There is a nice muted yellow/cream combinaiton that I have beceom fond of for background it is defiend by the HEX <code>#FDFAF1</code>. The good thing about this color is that it contrasts with many other colors that may be layered on top of it, in the same way that a white might, but not as boring.</p></li>
<li><p>For lettering black or dark gray will do just fine. Of late I have been using a glossy black for my work, defined by the HEX <code>#252324</code>.</p></li>
<li><p>If you will recall we defined a highlight variable with the categories of “up”. We will need to define those colors. We have to be cognizant of how those colors would look when contrasted with the yellowish background and we have to cognizant of possible colorblindness in those. reading our visual document. Colors suggested for people dealing with color blindness are Blues and Reds based on the web tool ColorBrewer.[<span class="citation" data-cites="2003Brewer-cb"><sup><a href="#ref-2003Brewer-cb" role="doc-biblioref">8</a></sup></span>]<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> I will go with Blue (HEX -#2C7BB6) for <strong>up</strong> and Red (HEX - #D7191C) for “down”.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Aesthetics ---</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>bkgcol    <span class="ot">&lt;-</span> <span class="st">"#FDFAF1"</span>    <span class="co"># Background Color</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>ttlcol    <span class="ot">&lt;-</span> <span class="st">"#252324"</span>    <span class="co"># Title Color         </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>subttlcol <span class="ot">&lt;-</span> <span class="st">"#252324"</span>    <span class="co"># Subtitle Color</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>capcol    <span class="ot">&lt;-</span> <span class="st">"#252324"</span>    <span class="co"># Caption Color</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>txtcol     <span class="ot">&lt;-</span> <span class="st">"#252324"</span>   <span class="co"># Text Color</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>highlight <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"up"</span> <span class="ot">=</span> <span class="st">"#2C7BB6"</span>, <span class="st">"down"</span> <span class="ot">=</span><span class="st">"#D7191C"</span>) <span class="co"># Colors for highlights </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="defining-the-font" class="level2">
<h2 class="anchored" data-anchor-id="defining-the-font">Defining the Font</h2>
<p>Note that we are using the Font Awesome version 6.4.0.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> Font Awesome is a package of fonts, icons, and emojis that you can use in HTML and markdown documents. It includes various symbols, icons, such as those used for social media and websits (thumbs up, smilely faces, twitter icon, instagram logo etc.). I want to have a little caption at the bottom of the data visualization document that has my contact information.</p>
<p>To be able to include those, you need to download the FontAwesome fonts. Once that is done, you can then call them into your code using <code>font_add()</code> function from the <code>systemfonts</code> package (It is automatically downloaded when you add the <code>showtext</code> package. You will have to specify a name and the location of the fontawesoe font style (formated as an otf file).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add</span>(<span class="st">'fa6-brands'</span>, <span class="st">'/Users/seyramb/Library/Fonts/Font Awesome 6 Brands-Regular-400.otf'</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="st">"Arvo"</span>, <span class="at">family =</span> <span class="st">"title"</span>) </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="st">"Arvo"</span>, <span class="at">family =</span> <span class="st">"subtitle"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="st">"Arvo"</span>, <span class="at">family =</span> <span class="st">"text"</span>)  </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="st">"Quicksand"</span>, <span class="at">family =</span> <span class="st">"caption"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>()     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="defining-titles-and-captions" class="level2">
<h2 class="anchored" data-anchor-id="defining-titles-and-captions">Defining Titles and Captions</h2>
<p>One of the great things about working in R with <code>ggplot</code> from the tidyverse is that you can define things like title and labels in objects and then simply call those objects into your chart when you create it as opposed to writing those out within the code of plot. It helps for a neater, less murky overall code. I am grateful to Steven Ponce, for providing a great working example to build off here. Below I use the <code>str_glue()</code> function. This particular function acts as a wrapper around the <code>glue()</code> and <code>glue_data()</code> function from the <code>glue</code> package. They provide a powerful and elegant syntax for interpolating strings with {}.</p>
<p>I then employ elements of HTML to add some additional caption information that will be included at the bottom of the chart, things like contact information. Take the following code:</p>
<blockquote class="blockquote">
<p><code>tw &lt;- str_glue("&lt;span style='font-family:Rockwell'&gt;&amp;#xf099;&lt;/span&gt;")</code></p>
</blockquote>
<p>It means that we are to create an object with a particular string (i.e., letters) pattern. Moreover, that string will have certain characteristics, including a font that is Rockwell. The string character itself is</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">str_glue</span>(<span class="st">"TidyTuesday: 2023 Week 23 &amp;bull; Source: Our World in Data - Energy&lt;br&gt;"</span>)  </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>tw <span class="ot">&lt;-</span> <span class="fu">str_glue</span>(<span class="st">"&lt;span style='font-family:fa6-brands'&gt;&amp;#xf099;&lt;/span&gt;"</span>) <span class="co"># Defines my twitter</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>gh <span class="ot">&lt;-</span> <span class="fu">str_glue</span>(<span class="st">"&lt;span style='font-family:fa6-brands'&gt;&amp;#xf09b;&lt;/span&gt;"</span>) <span class="co"># Defines my github</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>lk <span class="ot">&lt;-</span> <span class="fu">str_glue</span>(<span class="st">"&lt;span style='font-family:fa6-brands'&gt;&amp;#xf08c;&lt;/span&gt;"</span>) <span class="co"># Defines my LinkedIn account</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>up   <span class="ot">&lt;-</span> <span class="fu">str_glue</span>(<span class="st">"&lt;span style='font-size:11pt; color: #2C7BB6'&gt;**upward**&lt;/span&gt;"</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>down <span class="ot">&lt;-</span> <span class="fu">str_glue</span>(<span class="st">"&lt;span style='font-size:11pt; color: #D7191C'&gt;**downward**&lt;/span&gt;"</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>title_text    <span class="ot">&lt;-</span> <span class="fu">str_glue</span>(<span class="st">"China's electricity production by source (1965 - 2018)"</span>) </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>sub_text <span class="ot">&lt;-</span> <span class="fu">str_glue</span>(<span class="st">"The {up} and {down} trends in China's per capita electricity production"</span>) </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>cap_text  <span class="ot">&lt;-</span> <span class="fu">str_glue</span>(<span class="st">"{tt} Visualization: {tw} @butames &amp;bull; {lk} @butames Code: {gh} butames &amp;bull; Tools: #rstats #ggplot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-the-plot" class="level2">
<h2 class="anchored" data-anchor-id="create-the-plot">Create the Plot</h2>
<p>I am not going to walk through the use of the various functions within <code>ggplot</code>. I do just want to note the use of the <code>facet_wrap()</code> function which allows for the placement of multiple plots on the same document.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">!=</span> <span class="st">"Others"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> output, <span class="at">fill =</span> highlight)) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Geoms ----</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Scales ----</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1965</span>, <span class="dv">2018</span>, <span class="at">by =</span> <span class="dv">50</span>),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1965</span>, <span class="dv">2020</span>),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>()<span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> highlight) <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding Labels ----</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x        =</span> <span class="st">""</span>, </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y        =</span> <span class="st">"Kilowatt-hours"</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">title    =</span> title_text,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> sub_text,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption  =</span> cap_text) <span class="sc">+</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Facet warp ----</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(type), <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span> </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add Themes to the Plot ----</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position   =</span> <span class="st">"plot"</span>,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption.position =</span> <span class="st">"plot"</span>,</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position       =</span> <span class="st">"top"</span>,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background       =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> bkgcol, <span class="at">color =</span> bkgcol),</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background      =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> bkgcol, <span class="at">color =</span> bkgcol),</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin           =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">10</span>),</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title            =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">color =</span> txtcol, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">10</span>)),</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x           =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">linewidth =</span> <span class="fl">0.1</span>, <span class="at">color =</span> txtcol),</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y    =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"#57606C"</span>),</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y    =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x    =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.x    =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text            =</span> <span class="fu">element_textbox</span>(<span class="at">size    =</span> <span class="dv">10</span>,</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">face    =</span> <span class="st">"bold"</span>,</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">color   =</span> txtcol,</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">hjust   =</span> <span class="fl">0.5</span>,</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">halign  =</span> <span class="fl">0.5</span>,</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">r       =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">"pt"</span>),</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">width   =</span> <span class="fu">unit</span>(<span class="fl">5.5</span>, <span class="st">"npc"</span>),</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">padding =</span> <span class="fu">margin</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>),</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">margin  =</span> <span class="fu">margin</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">fill    =</span> <span class="st">"transparent"</span>),</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing         =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title            =</span> <span class="fu">element_markdown</span>(</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>          <span class="at">family              =</span> <span class="st">"title"</span>,</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">color               =</span> ttlcol,</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">face                =</span> <span class="st">"bold"</span>,</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>          <span class="at">size                =</span> <span class="dv">12</span>,</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>          <span class="at">hjust               =</span> <span class="fl">0.5</span>,</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>          <span class="at">halign              =</span> <span class="fl">0.5</span>,</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>          <span class="at">margin              =</span> <span class="fu">margin</span>(<span class="at">t =</span><span class="dv">10</span>, <span class="at">b =</span> <span class="dv">5</span>)),</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle         =</span> <span class="fu">element_markdown</span>(</span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>          <span class="at">family              =</span> <span class="st">"text"</span>,</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>          <span class="at">color               =</span> ttlcol,</span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>          <span class="at">size                =</span> <span class="dv">10</span>,</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>          <span class="at">hjust               =</span> <span class="fl">0.5</span>,</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>          <span class="at">halign              =</span> <span class="fl">0.5</span>,</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>          <span class="at">margin              =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">5</span>, <span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption          =</span> <span class="fu">element_markdown</span>(</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">family            =</span> <span class="st">"caption"</span>,</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>            <span class="at">color             =</span> capcol,</span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>            <span class="at">lineheight        =</span> <span class="fl">0.6</span>,</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>            <span class="at">size              =</span> <span class="dv">8</span>,</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust             =</span> <span class="fl">0.5</span>,</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>            <span class="at">halign            =</span> <span class="fl">0.5</span>,</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>            <span class="at">margin            =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">10</span>))</span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<figure class="img1 figure">
<img src="img/sabfinal.jpg" alt="Final data viz document" width="45%" class="figure-img">
<figcaption class="figcap figure-caption">
Figure 3 - Final data visualization document.
</figcaption>
</figure>
<p>It came out rather nicely from what I can see. Over the course of nearly 6 decades, China experienced energy growth, in terms of per-capita kilowatt-hours. This growth appears to be exponential for all energy sources except Crude oil. This makes sense, during that time, China went from a large sovereign state experimenting with communism to an economic behemoth that manages to blend elements of capitalism and communism (at least the way Western propaganda plays it). Consequently, it makes sense for China to experience demand driven increases in energy generation. One surprising finding was the decline in Crude oil as a source, but again that makes quite a bit of sense. With the specter of climate change, an industrialized country like China must be working hard to do its part to curb greenhouse emissions. The reviled image of China makes it an easy target for critics from developed economies to focus their ire and point to China as a source for the problems related to climate. A reliance on renewables and a decrease in the use of oil, can help China create and preserve an image of being part of the international community that seeks to address the climate challenges. And then of course there are local health and wellness concerns. I vividly remember the hazy skyline that was shown repeatedly on TV in the lead up to the Beijing Olympics.</p>

</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-line-spacing="2" role="list">
<div id="ref-hughes2019-st" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Hughes, E., Harmon, J., Mock, T. &amp; Community, R. O. L. <a href="https://thebioengineer.github.io/tidytuesdayR/">Access the <span>Weekly</span> <span>TidyTuesday</span> <span>Project</span> <span>Dataset</span> (tidytuesday)</a>. <em>tidytuesdayR</em> (2019).</div>
</div>
<div id="ref-2019Wickham-td" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Wickham, H. <em>et al.</em> <a href="https://doi.org/10.21105/joss.01686">Welcome to the <span class="nocase">tidyverse</span></a>. <em>Journal of Open Source Software</em> <strong>4</strong>, 1686 (2019).</div>
</div>
<div id="ref-2022Wilke-wt" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Wilke, C. O. &amp; Wiernik, B. M. <a href="https://CRAN.R-project.org/package=ggtext">Ggtext: Improved text rendering support for ’ggplot2’</a>. (2022).</div>
</div>
<div id="ref-2022Qiu-px" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Qiu, Y. &amp; See file AUTHORS for details., authors/contributors of the included software. <a href="https://CRAN.R-project.org/package=showtext">Showtext: Using fonts more easily in r graphs</a>. (2022).</div>
</div>
<div id="ref-2023Firke-jw" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Firke, S. <a href="https://CRAN.R-project.org/package=janitor">Janitor: Simple tools for examining and cleaning dirty data</a>. (2023).</div>
</div>
<div id="ref-2022Hughes-cc" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Hughes, E. <a href="https://CRAN.R-project.org/package=camcorder">Camcorder: Record your plot history</a>. (2022).</div>
</div>
<div id="ref-2020Müller-hr" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Müller, K. <a href="https://CRAN.R-project.org/package=here">Here: A simpler way to find your files</a>. (2020).</div>
</div>
<div id="ref-2003Brewer-cb" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Cynthia A. Brewer, Geoffrey W. Hatchard &amp; Harrower, M. A. ColorBrewer in print: A catalog of color schemes for maps. <em>Cartography and Geographic Information Science</em> <strong>30</strong>, 5–32 (2003).</div>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The iso-code system was developed by the International Organization for Standardization (ISO) to identify countries, dependent territories, and special areas of geographical interest.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Source: https://colorbrewer2.org/<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>https://fontawesome.com/download<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>